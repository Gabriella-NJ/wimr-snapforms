<div id=D__ID>
    <section id=form_container__ID bp=576 style='display:flow-root;'>
        <div class=header__ID>
            <h1 class=t1__ID>Send Email to Patient</h1>
        </div>
    	<form id=F__ID>
			<div class=r__ID>
				<div w='100|50'>
					<span><b>First Name</b></span>
					<input type="text" name=First_Name required autocomplete=off required />
				</div>
				<div w='100|50'>
					<span><b>Last Name</b></span>
					<input type=text name=Last_Name required autocomplete=off required />
				</div>
			</div>
			<div class=r__ID>
				<div w='100|50'>
					<span><b>Date of Birth</b></span>
					<input type=date name=Date_of_Birth ></input>
				</div>
				<div w='100|50'>
					<span><b>Email Address</b></span>
					<input type=text name=Email required></input>
				</div>
			</div>
			<div class=r__ID>
				<div w='100|50'>
					<span><b>Appointment with</b></span>
					<input type=text name=Appointment_with ></input>
				</div>
			</div>
			<div class=r__ID>
				<div w='100|100'>
					<span><b>Appointment Link</b></span>
					<input type=text name=Appointment_link ></input>
				</div>
			</div>
			<div class=r__ID>
				<div w='100|100'>
					<span><b>Email Template</b></span>
					<select name=Template required >
                        <option></option>
                        <option>Appointment Confirmation</option>
                        <option>Consult Registration</option>
                        <option>Sleep Registration</option>
                    </select>
				</div>
			</div>
			<div class=r__ID>
				<div w='100|100'>
                    <button id=submit__ID type=button >Preview Email</button>
				</div>
			</div>
			<br><br>
    	</form>
    </section>
	VmInclude:__COMPONENT__/m/model.01.html
    <script>
    	function F__ID(){
    		//-------------------------------------
			/*V mInclude:__COMPONENT__/f/form.01.js*/
			new ResizeObserver($vm.responsive).observe(form_container__ID);
			//-------------------------------------
            $('#submit__ID').on('click',function(){
                var First_Name=$('#F__ID input[name=First_Name]').val();
                var Last_Name=$('#F__ID input[name=Last_Name]').val();
                var Date_of_Birth=$('#F__ID input[name=Date_of_Birth]').val();
                var Email=$('#F__ID input[name=Email]').val();
                var Appointment_with=$('#F__ID input[name=Appointment_with]').val();
                var Appointment_link=$('#F__ID input[name=Appointment_link]').val();
                var Template=$('#F__ID select[name=Template]').val();
                var URL="?first name="+First_Name+"&surname="+Last_Name+"&dob="+$vm.yyyymmdd_to_ddmmyyyy(Date_of_Birth);
                URL=encodeURI(URL);
				var data={
                    first_name: First_Name,
                    last_name: Last_Name,
                    date_of_birth: Date_of_Birth,
                    email: Email,
                    appointment_with: Appointment_with,
                    appointment_link: Appointment_link,
                    snapforms_url: URL,
					template:Template
                }
                /*
				$vm.request({cmd:'flow',flowid:$('#F__ID select[name=Template]').val(),data:data},function(res){
                    if(res.status=="ok") alert("The email has been sent.");
					else if(res.status=="np") alert("No permissions.");
                })
				*/
				var m=$vm.module_list['__MODULE__'];
				var p=m.prefix;
				var name="";
				switch(Template){
					case "Appointment Confirmation": name="preview-appointment-confirmation"; break;
					case "Consult Registration": name="preview-consult-registration"; break;
					case "Sleep Registration": name="preview-sleep-registration"; break;
				}
				if(name!="") $vm.show_module(p+name,{data:data});
            })
			//-------------------------------------
		}
    </script>
    <style>
        #form_container__ID{
            max-width:700px;
        }
		/*VmInclude:__CURRENT_PATH__form.css*/
    </style>
</div>
